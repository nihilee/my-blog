{:title "Cryogen 博客框架详细使用指南"
 :date "2026-01-08"
 :tags ["Cryogen" "博客框架" "静态博客" "Clojure" "指南"]
 :author "xuh"
 :toc true
 :description "详细介绍 Cryogen 静态博客框架的使用方法，包括环境搭建、配置、主题系统和高级功能等"}

# Cryogen 博客框架详细使用指南

## 1. 框架概述

Cryogen 是一个用 Clojure 编写的简单、快速的静态博客生成器。它允许用户使用 Markdown 或 AsciiDoc 编写内容，然后生成纯静态 HTML 文件，可以轻松部署到任何 Web 服务器上。

### 1.1 核心功能

- **静态生成**：将 Markdown/AsciiDoc 内容转换为纯静态 HTML 文件
- **多格式支持**：支持 Markdown (.md) 和 AsciiDoc (.asc) 两种文档格式
- **主题系统**：内置多种主题，支持自定义主题
- **本地预览**：提供开发服务器，支持实时预览和热重载
- **内容组织**：支持文章、页面、标签、归档等结构
- **RSS 订阅**：自动生成 RSS 订阅源
- **评论集成**：支持 Disqus 评论系统
- **社交媒体集成**：支持 Twitter 和 Mastodon 链接

### 1.2 架构特点

- **分离关注点**：内容与表现分离，便于维护和扩展
- **简单配置**：使用 EDN 格式的配置文件，简洁易懂
- **插件系统**：支持扩展功能
- **快速构建**：基于 Clojure 的高效编译系统

### 1.3 适用场景

- 个人技术博客
- 项目文档站点
- 团队知识库
- 静态产品展示页
- 需要快速部署的内容网站

### 1.4 技术优势

- **无需数据库**：生成纯静态文件，部署简单
- **高性能**：静态文件加载速度快，减轻服务器压力
- **安全性高**：无服务器端代码，减少安全漏洞
- **易于备份**：所有内容都是文本文件，便于版本控制和备份
- **灵活扩展**：支持自定义主题和插件

## 2. 环境搭建

### 2.1 安装依赖

Cryogen 基于 Clojure 构建，需要安装以下依赖：

#### 2.1.1 Java 开发环境

Cryogen 需要 Java 8 或更高版本。安装方法：

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install openjdk-11-jdk

# CentOS/RHEL
sudo yum install java-11-openjdk-devel

# macOS (使用 Homebrew)
brew install openjdk@11
```

验证安装：
```bash
java -version
```

#### 2.1.2 Leiningen

Leiningen 是 Clojure 的构建工具。安装方法：

```bash
# Linux/macOS
curl https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein > lein
chmod +x lein
sudo mv lein /usr/local/bin/

# Windows
# 下载 https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein.bat 并添加到 PATH
```

验证安装：
```bash
lein version
```

### 2.2 获取 Cryogen

直接克隆或下载本项目：

```bash
git clone <repository-url> my-blog
cd my-blog
```

## 3. 配置文件说明

Cryogen 的主要配置文件是 `content/config.edn`，使用 EDN (Clojure 的数据格式) 编写。

### 3.1 核心配置项

```edn
{:site-title                   "My Awesome Blog"  ; 网站标题
 :author                       "Bob Bobbert"     ; 作者名称
 :description                  "This blog is awesome"  ; 网站描述
 :site-url                     "http://blogawesome.com/"  ; 网站 URL
 :post-root                    "posts"          ; 文章目录
 :page-root                    "pages"          ; 页面目录
 :post-root-uri                "posts-output"   ; 文章输出路径
 :page-root-uri                "pages-output"   ; 页面输出路径
 :tag-root-uri                 "tags-output"    ; 标签输出路径
 :author-root-uri              "authors-output" ; 作者输出路径
 :public-dest                  "public"         ; 静态文件输出目录
 :blog-prefix                  "/blog"          ; 博客前缀路径
 :rss-name                     "feed.xml"       ; RSS 文件名
 :rss-filters                  ["cryogen"]      ; RSS 过滤标签
 :recent-posts                 3                ; 首页显示的最新文章数
 :post-date-format             "yyyy-MM-dd"     ; 文章日期格式
 :archive-group-format         "yyyy MMMM"      ; 归档分组格式
 :theme                        "blue"           ; 使用的主题
 :resources                    ["img"]          ; 资源目录
 :keep-files                   [".git"]         ; 生成时保留的文件
 :disqus?                      false            ; 是否启用 Disqus 评论
 :disqus-shortname             ""               ; Disqus 短名称
 :previews?                    false            ; 是否显示文章预览
 :posts-per-page               5                ; 每页显示的文章数
 :blocks-per-preview           2                ; 预览显示的区块数
 :clean-urls                   :trailing-slash  ; URL 格式 (:trailing-slash/:no-trailing-slash/:dirty)
 :collapse-subdirs?            false            ; 是否折叠子目录
 :hide-future-posts?           true             ; 是否隐藏未来日期的文章
 :twitter-acct                 nil              ; Twitter 账号
 :mastodon                     {:host nil        ; Mastodon 主机
                                :acct nil        ; Mastodon 账号
                                }}
```

### 3.2 配置项详解

- **site-title**: 网站的标题，将显示在浏览器标签和首页
- **author**: 博客作者名称
- **description**: 网站的简短描述，用于 SEO 和 RSS
- **site-url**: 网站的完整 URL，用于生成 RSS 和绝对链接
- **post-root/page-root**: 内容目录中存放文章/页面的子目录
- **post-root-uri/page-root-uri**: 生成的静态文件中文章/页面的路径
- **public-dest**: 生成的静态 HTML 文件的输出目录
- **blog-prefix**: 博客在网站中的前缀路径，如 `/blog`
- **theme**: 使用的主题名称，必须与 `themes/` 目录下的主题目录名一致
- **clean-urls**: URL 格式选项：
  - `:trailing-slash`: `/posts/2023-01-01/my-post/`
  - `:no-trailing-slash`: `/posts/2023-01-01/my-post`
  - `:dirty`: `/posts/2023-01-01/my-post.html`
- **previews?**: 是否在首页和归档页显示文章预览而不是完整内容
- **disqus?/disqus-shortname**: 启用 Disqus 评论并配置短名称

## 4. 核心命令详解

### 4.1 编译生成静态文件

```bash
lein run
```

该命令将编译 `content/` 目录中的所有内容，并将生成的静态文件输出到 `public/` 目录。

### 4.2 本地预览服务器

```bash
lein serve
```

启动本地预览服务器，默认监听端口 3000。在浏览器中访问 `http://localhost:3000` 即可查看博客。

### 4.3 快速预览（热重载）

```bash
lein serve:fast
```

启动快速预览服务器，支持热重载功能。当修改内容或主题时，页面会自动刷新，无需手动重新编译。

## 5. 创建新博客流程

### 5.1 目录结构

在开始创建内容之前，先了解一下 Cryogen 的目录结构：

```
my-blog/
├── content/                # 内容目录
│   ├── md/                 # Markdown 格式内容
│   │   ├── posts/          # 博客文章
│   │   └── pages/          # 页面
│   ├── asc/                # AsciiDoc 格式内容
│   ├── css/                # 自定义 CSS
│   ├── img/                # 图片资源
│   └── config.edn          # 配置文件
├── themes/                 # 主题目录
├── src/                    # 源代码
└── public/                 # 生成的静态文件
```

### 5.2 创建新文章

#### 5.2.1 使用 Markdown 格式

在 `content/md/posts/` 目录下创建一个新文件，命名格式为 `YYYY-MM-DD-文章标题.md`，例如：

```bash
nano content/md/posts/2023-01-15-我的第一篇博客.md
```

文章内容格式如下：

```markdown
{:title "我的第一篇博客"  ; 文章标题
 :date "2023-01-15"     ; 发布日期
 :tags ["入门" "指南"]   ; 标签
 :author "张三"         ; 作者（可选）
 :description "这是我的第一篇博客文章"}  ; 描述（可选）

# 欢迎阅读我的博客

这是我的第一篇博客文章，使用 Cryogen 博客框架创建。

## 什么是 Cryogen？

Cryogen 是一个用 Clojure 编写的静态博客生成器...
```

#### 5.2.2 使用 AsciiDoc 格式

在 `content/asc/posts/` 目录下创建一个新文件，命名格式为 `YYYY-MM-DD-文章标题.asc`，例如：

```bash
nano content/asc/posts/2023-01-15-我的第一篇博客.asc
```

文章内容格式如下：

```asciidoc
= 我的第一篇博客
张三
2023-01-15
:tags: 入门, 指南
:description: 这是我的第一篇博客文章

欢迎阅读我的博客
----------------

这是我的第一篇博客文章，使用 Cryogen 博客框架创建。

== 什么是 Cryogen？

Cryogen 是一个用 Clojure 编写的静态博客生成器...
```

#### 5.2.3 文章头部元数据详解

Cryogen 使用 EDN 格式的元数据来定义文章的属性，这些元数据位于文章文件的顶部。以下是常用的元数据关键字及其含义：

| 关键字 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `:title` | 字符串 | 是 | 文章的标题，将显示在文章页面、文章列表和浏览器标签中 |
| `:layout` | 关键字 | 否 | 指定文章使用的布局模板，默认为 `:post`，页面通常使用 `:page` |
| `:tags` | 字符串数组 | 否 | 文章的标签，用于分类和筛选文章，支持多个标签 |
| `:toc` | 布尔值 | 否 | 是否自动生成文章目录，设置为 `true` 时会根据标题层级生成目录 |
| `:date` | 字符串 | 否 | 文章的发布日期，格式为 `YYYY-MM-DD`，如果不指定则使用文件创建日期 |
| `:author` | 字符串 | 否 | 文章的作者，将显示在文章页面和文章列表中 |
| `:description` | 字符串 | 否 | 文章的简短描述，用于 SEO、RSS 订阅和文章预览 |

#### 详细解释：

1. **`:title`**
   - 用于定义文章的标题
   - 示例：`{:title "我的第一篇博客"}`
   - 标题将显示在多个位置，包括文章页面的顶部、首页的文章列表和浏览器的标签栏

2. **`:layout`**
   - 指定文章使用的布局模板
   - 可选值：`:post`（默认，用于博客文章）、`:page`（用于独立页面）
   - 示例：`{:layout :post}` 或 `{:layout :page}`
   - 布局模板位于 `themes/{theme}/html/` 目录下，如 `post.html` 和 `page.html`

3. **`:tags`**
   - 用于为文章添加标签，便于分类和筛选
   - 格式：字符串数组，支持多个标签
   - 示例：`{:tags ["技术" "编程" "Clojure"]}`
   - Cryogen 会自动生成标签页面，访问 `/tags-output/标签名/` 可以查看所有带有该标签的文章

4. **`:toc`**
   - 控制是否为文章生成目录
   - 可选值：`true`（生成目录）、`false`（不生成目录）
   - 示例：`{:toc true}`
   - 目录会根据文章的标题层级（`#`, `##`, `###` 等）自动生成

5. **`:date`**
   - 指定文章的发布日期
   - 格式：`YYYY-MM-DD`
   - 示例：`{:date "2023-01-15"}`
   - 如果不指定，Cryogen 会使用文件的创建日期作为发布日期
   - 日期用于文章的排序和归档页面的分组

6. **`:author`**
   - 指定文章的作者
   - 示例：`{:author "张三"}`
   - 作者信息会显示在文章页面和文章列表中（取决于主题）

7. **`:description`**
   - 为文章提供简短的描述
   - 示例：`{:description "这篇文章介绍了 Clojure 的基本语法"}`
   - 描述会用于：
     - SEO（搜索引擎优化）的 meta 标签
     - RSS 订阅源中的文章摘要
     - 文章预览中的显示文本（如果启用了预览功能）

#### 使用示例：

```markdown
{:title "Clojure 入门教程"       ; 文章标题
 :date "2023-02-20"           ; 发布日期
 :tags ["Clojure" "编程" "入门"]  ; 文章标签
 :author "李四"               ; 文章作者
 :layout :post                ; 使用文章布局
 :toc true                    ; 生成目录
 :description "从零开始学习 Clojure 编程语言的基础语法和核心概念"}  ; 文章描述
```

通过合理使用这些元数据，可以使博客文章的结构更加清晰，同时提高内容的可发现性和用户体验。

### 5.3 创建新页面

页面与文章类似，但不会出现在文章列表中，通常用于创建 "关于我"、"联系方式" 等独立页面。

在 `content/md/pages/` 目录下创建一个新文件，例如：

```bash
nano content/md/pages/about.md
```

页面内容格式：

```markdown
{:title "关于我"  ; 页面标题
 :layout :page   ; 布局类型
 :author "张三"  ; 作者（可选）}

# 关于我

我是张三，一个热爱技术的开发者...
```

### 5.4 编辑内容

使用你喜欢的文本编辑器编辑 Markdown 或 AsciiDoc 文件即可。Cryogen 支持标准的 Markdown 语法和 AsciiDoc 语法。

### 5.5 本地预览

在编辑内容时，可以使用本地预览功能实时查看效果：

```bash
lein serve:fast
```

然后在浏览器中访问 `http://localhost:3000`，修改内容后页面会自动刷新。

### 5.6 发布博客

当内容编辑完成后，执行以下步骤发布博客：

1. **编译生成静态文件**：
   ```bash
   lein run
   ```

2. **部署到服务器**：
   将 `public/` 目录中的所有文件上传到你的 Web 服务器。可以使用 FTP、SCP 或部署工具（如 rsync、git）。

   示例：使用 rsync 部署
   ```bash
   rsync -avz --delete public/ user@your-server.com:/var/www/blog/
   ```

### 5.7 阿里云Nginx服务器部署详解

以下是在阿里云ECS服务器上部署Cryogen博客的完整步骤：

#### 5.7.1 服务器环境准备

1. **创建阿里云ECS实例**
   - 登录阿里云控制台，选择ECS服务
   - 点击"创建实例"，选择合适的配置（建议至少1核2G内存）
   - 选择操作系统：推荐CentOS 7.x或Ubuntu 18.04+ LTS版本
   - 配置网络和安全组，确保开放80（HTTP）和443（HTTPS）端口
   - 完成实例创建并获取公网IP地址

2. **连接服务器**
   - 使用SSH工具连接服务器（如Xshell、Putty或Terminal）
   - 命令示例：
     ```bash
     ssh root@your_server_ip
     ```

3. **更新系统**
   - CentOS系统：
     ```bash
     yum update -y
     ```
   - Ubuntu系统：
     ```bash
     apt update -y && apt upgrade -y
     ```

#### 5.7.2 安装并配置Nginx

1. **安装Nginx**
   - CentOS系统：
     ```bash
     yum install nginx -y
     ```
   - Ubuntu系统：
     ```bash
     apt install nginx -y
     ```

2. **启动Nginx服务**
   ```bash
   systemctl start nginx
   systemctl enable nginx  # 设置开机自启
   ```

3. **验证Nginx安装**
   - 在浏览器中访问服务器公网IP，如果看到Nginx欢迎页面则安装成功
   - 或在服务器上执行：
     ```bash
     curl localhost
     ```

4. **创建博客网站目录**
   ```bash
   mkdir -p /var/www/my-blog
   ```

#### 5.7.3 传输本地文件至服务器

在本地电脑上执行以下操作：

1. **编译生成静态文件**
   ```bash
   lein run
   ```

2. **使用SCP传输文件**
   ```bash
   scp -r public/* root@your_server_ip:/var/www/my-blog/
   ```

3. **或使用rsync传输文件**（推荐，支持增量传输）
   ```bash
   rsync -avz --delete public/ root@your_server_ip:/var/www/my-blog/
   ```

#### 5.7.4 配置Nginx虚拟主机

1. **创建Nginx配置文件**
   ```bash
   vi /etc/nginx/conf.d/my-blog.conf
   ```

2. **添加以下配置内容**
   ```nginx
   server {
       listen 80;
       server_name your_domain.com;  # 替换为你的域名或公网IP

       root /var/www/my-blog;
       index index.html;

       # 设置正确的MIME类型
       types {
           text/html   html htm shtml;
           text/css    css;
           text/xml    xml;
           text/plain  txt;
           application/rss+xml rss xml;
           application/json json;
           application/javascript js;
           application/pdf pdf;
           application/octet-stream bin exe dll;
           image/gif   gif;
           image/jpeg  jpeg jpg;
           image/png   png;
           image/tiff  tiff;
           image/svg+xml svg;
       }

       # 静态资源缓存
       location ~* \.(jpg|jpeg|png|gif|ico|css|js|xml|rss|pdf)$ {
           expires 1y;
           add_header Cache-Control "public, immutable";
       }

       # 处理404错误
       error_page 404 /404.html;

       # 防止直接访问隐藏文件
       location ~ /\. {
           deny all;
       }
   }
   ```

3. **检查Nginx配置语法**
   ```bash
   nginx -t
   ```

4. **重新加载Nginx配置**
   ```bash
   systemctl reload nginx
   ```

#### 5.7.5 测试部署结果

1. **验证网站可访问性**
   - 在浏览器中访问你的域名或服务器公网IP
   - 检查博客首页、文章列表、单篇文章、标签页面等是否正常显示

2. **测试关键功能**
   - 点击文章标题，检查文章内容是否完整显示
   - 测试标签功能，检查是否能正确筛选文章
   - 验证RSS订阅功能，访问`/blog/feed.xml`（根据实际配置调整路径）

3. **检查控制台错误**
   - 打开浏览器开发者工具（F12），检查Console和Network面板是否有错误
   - 确保所有CSS、JS和图片资源都能正常加载

#### 5.7.6 可选：配置HTTPS

为了提高网站安全性，建议配置HTTPS：

1. **安装Certbot**
   - CentOS系统：
     ```bash
     yum install epel-release -y
     yum install certbot python2-certbot-nginx -y
     ```
   - Ubuntu系统：
     ```bash
     apt install certbot python3-certbot-nginx -y
     ```

2. **获取SSL证书**
   ```bash
   certbot --nginx -d your_domain.com
   ```

3. **按照提示完成配置**
   - 选择是否重定向HTTP到HTTPS（建议选择"2"进行永久重定向）

4. **验证HTTPS配置**
   - 在浏览器中访问`https://your_domain.com`
   - 检查地址栏是否显示安全锁图标

## 6. 主题系统

Cryogen 提供了灵活的主题系统，默认包含以下主题：

- **blue**：蓝色主题
- **blue_centered**：居中布局的蓝色主题
- **nucleus**：现代简约主题
- **lotus**：优雅的绿色主题

### 6.1 切换主题

修改 `content/config.edn` 文件中的 `:theme` 配置项：

```edn
:theme "lotus"
```

然后重新编译：

```bash
lein run
```

### 6.2 自定义主题

1. 在 `themes/` 目录下创建一个新的主题目录，例如 `my-theme`

2. 复制现有主题的结构：
   ```
   my-theme/
   ├── css/          # CSS 文件
   ├── js/           # JavaScript 文件
   ├── html/         # HTML 模板
   └── img/          # 图片资源
   ```

3. 修改模板文件，模板使用 Selmer 模板引擎（类似 Django 模板）

4. 在配置文件中启用新主题：
   ```edn
   :theme "my-theme"
   ```

## 7. 高级功能

### 7.1 使用标签

在文章头部添加 `:tags` 配置项即可为文章添加标签：

```markdown
{:title "我的第一篇博客"
 :date "2023-01-15"
 :tags ["入门" "指南"]}
```

Cryogen 会自动生成标签页面，访问 `/tags-output/标签名/` 可以查看所有带有该标签的文章。

### 7.2 文章归档

Cryogen 会自动生成按月份分组的文章归档页面，访问 `/archives/` 即可查看。

### 7.3 RSS 订阅

Cryogen 默认生成 RSS 订阅文件 `feed.xml`，访问 `/blog/feed.xml`（根据 `blog-prefix` 配置调整路径）即可获取订阅链接。

可以通过 `:rss-filters` 配置项过滤 RSS 内容：

```edn
:rss-filters ["技术" "编程"]  ; 只包含带有这些标签的文章
```

### 7.4 Disqus 评论

1. 注册 Disqus 账号并创建一个新站点
2. 在配置文件中启用 Disqus：
   ```edn
   :disqus? true
   :disqus-shortname "your-disqus-shortname"
   ```
3. 重新编译并部署

### 7.5 社交媒体集成

#### 7.5.1 Twitter

配置 Twitter 账号，文章页面会自动显示 Twitter 分享按钮：

```edn
:twitter-acct "your-twitter-handle"
```

#### 7.5.2 Mastodon

配置 Mastodon 账号：

```edn
:mastodon {:host "mastodon.social"  ; Mastodon 实例
           :acct "your-username"    ; Mastodon 用户名
          }
```

## 8. 常见问题与解决方案

### 8.1 页面不显示最新内容

确保已重新编译并刷新页面：

```bash
lein run
```

如果使用本地预览，尝试使用快速预览模式：

```bash
lein serve:fast
```

### 8.2 主题修改不生效

确保主题目录名称与配置文件中的 `:theme` 配置一致，并且已重新编译。

### 8.3 中文显示问题

Cryogen 默认支持 UTF-8 编码，确保文本编辑器保存文件时使用 UTF-8 编码。

### 8.4 页面样式错乱

检查是否修改了主题的 CSS 文件，或是否在 `content/css/` 目录中添加了冲突的自定义 CSS。

## 9. 总结

Cryogen 是一个简单、高效的静态博客生成器，适合个人博客、技术文档等场景。它的主要优点包括：

- 简单易用，学习曲线平缓
- 生成纯静态文件，部署方便
- 支持 Markdown 和 AsciiDoc 格式
- 灵活的主题系统
- 本地预览和热重载功能
- 丰富的扩展功能

通过本指南，你应该已经掌握了 Cryogen 的基本使用方法，可以开始创建和部署自己的博客了。祝你使用愉快！

## 10. 附录

### 10.1 快捷键和技巧

- 使用 `lein serve:fast` 进行快速预览和热重载
- 使用 Git 对博客内容进行版本控制
- 定期备份 `content/` 目录和 `themes/` 目录

### 10.2 资源链接

- [Cryogen 官方文档](http://cryogenweb.org/)
- [Markdown 语法指南](https://www.markdownguide.org/)
- [AsciiDoc 语法指南](https://asciidoc.org/)
- [Clojure 官方网站](https://clojure.org/)